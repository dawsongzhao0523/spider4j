# Spider Javaç‰ˆæœ¬é€»è¾‘éªŒè¯æ¡†æ¶ - å®Œæˆæ€»ç»“

## é¡¹ç›®æ¦‚è¿°

æ‚¨çš„Spideré¡¹ç›®Javaç‰ˆæœ¬é€»è¾‘éªŒè¯æ¡†æ¶å·²å®Œæˆï¼è¿™ä¸ªæ¡†æ¶ä½¿ç”¨é¡¹ç›®ä¸­çš„`baselines`ã€`data`ã€`eval_test`ã€`evaluation_examples`æ•°æ®è¿›è¡Œå…¨é¢çš„éªŒè¯æµ‹è¯•ï¼Œç¡®ä¿æ‚¨é‡å†™çš„Spideré€»è¾‘ä¸åŸå§‹Pythonç‰ˆæœ¬ä¿æŒä¸€è‡´ã€‚

## å·²å®Œæˆçš„æ ¸å¿ƒç»„ä»¶

### 1. æ ¸å¿ƒéªŒè¯æµ‹è¯•ç±» âœ…
**æ–‡ä»¶**: `src/test/java/com/nl2sql/spider/SpiderLogicValidationTest.java`

åŒ…å«6ä¸ªå…¨é¢çš„éªŒè¯æµ‹è¯•ï¼š
- âœ… **testEvaluationExamples** - éªŒè¯evaluation_examplesä¸­çš„ç¤ºä¾‹æ•°æ®
- âœ… **testEvalTestData** - éªŒè¯eval_testä¸­çš„æµ‹è¯•æ•°æ®  
- âœ… **testDevDataset** - éªŒè¯devæ•°æ®é›†
- âœ… **testBaselinesModels** - éªŒè¯baselinesä¸­çš„ä¸åŒæ¨¡å‹ç»“æœ
- âœ… **testEvaluationTypeConsistency** - éªŒè¯ä¸åŒè¯„ä¼°ç±»å‹çš„ä¸€è‡´æ€§
- âœ… **testErrorHandling** - éªŒè¯é”™è¯¯å¤„ç†æœºåˆ¶

### 2. æ•°æ®éªŒè¯å·¥å…· âœ…
**æ–‡ä»¶**: `src/main/java/com/nl2sql/spider/utils/DataValidator.java`

å®Œæ•´çš„æ•°æ®éªŒè¯å·¥å…·ç±»ï¼š
- âœ… éªŒè¯ç›®å½•ç»“æ„å®Œæ•´æ€§
- âœ… éªŒè¯JSONæ–‡ä»¶æ ¼å¼æ­£ç¡®æ€§ï¼ˆtables.json, dev.json, train_spider.jsonï¼‰
- âœ… éªŒè¯SQLæ–‡ä»¶æ ¼å¼æ­£ç¡®æ€§ï¼ˆdev_gold.sql, train_gold.sqlï¼‰
- âœ… éªŒè¯æ•°æ®åº“æ–‡ä»¶å­˜åœ¨æ€§ï¼ˆSQLiteæ–‡ä»¶ï¼‰
- âœ… éªŒè¯æ•°æ®ä¸€è‡´æ€§ï¼ˆdb_idåŒ¹é…ï¼‰

### 3. éªŒè¯å‘½ä»¤è¡Œå·¥å…· âœ…
**æ–‡ä»¶**: `src/main/java/com/nl2sql/spider/SpiderValidationCLI.java`

æä¾›ä¸‰ç§éªŒè¯æ¨¡å¼ï¼š
- âœ… **validate-data** - æ•°æ®å®Œæ•´æ€§éªŒè¯
- âœ… **validate-logic** - é€»è¾‘æ­£ç¡®æ€§éªŒè¯
- âœ… **validate-all** - å®Œæ•´éªŒè¯ï¼ˆæ•°æ®+é€»è¾‘ï¼‰

### 4. è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬ âœ…
**æ–‡ä»¶**: `validate_spider.sh`

ä¸€é”®è¿è¡Œå®Œæ•´éªŒè¯æµç¨‹ï¼š
- âœ… ç¼–è¯‘é¡¹ç›®
- âœ… è¿è¡Œé€»è¾‘éªŒè¯æµ‹è¯•
- âœ… æ„å»ºJARåŒ…
- âœ… éªŒè¯æ•°æ®å®Œæ•´æ€§
- âœ… éªŒè¯evaluation_examples
- âœ… éªŒè¯eval_test
- âœ… éªŒè¯baselinesæ¨¡å‹
- âœ… è¿è¡Œå®Œæ•´éªŒè¯

### 5. è¯¦ç»†æ–‡æ¡£ âœ…
**æ–‡ä»¶**: `VALIDATION_README.md`

åŒ…å«å®Œæ•´çš„ä½¿ç”¨è¯´æ˜ï¼š
- âœ… ç¯å¢ƒè¦æ±‚
- âœ… å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… è¯¦ç»†çš„å‘½ä»¤è¯´æ˜
- âœ… æ•…éšœæ’é™¤æŒ‡å—
- âœ… æ‰©å±•åŠŸèƒ½è¯´æ˜

## éªŒè¯æ•°æ®æºè¦†ç›–

### âœ… data/spider/ - Spideræ ¸å¿ƒæ•°æ®é›†
- tables.json - æ•°æ®åº“è¡¨ç»“æ„
- dev.json - å¼€å‘é›†æ•°æ®
- dev_gold.sql - å¼€å‘é›†æ ‡å‡†ç­”æ¡ˆ
- train_spider.json - è®­ç»ƒé›†æ•°æ®
- train_gold.sql - è®­ç»ƒé›†æ ‡å‡†ç­”æ¡ˆ
- database/ - SQLiteæ•°æ®åº“æ–‡ä»¶

### âœ… evaluation_examples/ - è¯„ä¼°ç¤ºä¾‹æ•°æ®
- gold_example.txt - ç¤ºä¾‹æ ‡å‡†ç­”æ¡ˆ
- pred_example.txt - ç¤ºä¾‹é¢„æµ‹ç»“æœ
- eval_result_example.txt - ç¤ºä¾‹è¯„ä¼°ç»“æœ

### âœ… eval_test/ - è¯„ä¼°æµ‹è¯•æ•°æ®
- gold.txt - æµ‹è¯•æ ‡å‡†ç­”æ¡ˆ
- pred.txt - æµ‹è¯•é¢„æµ‹ç»“æœ

### âœ… baselines/ - åŸºçº¿æ¨¡å‹ç»“æœ
- typesql/ - TypeSQLæ¨¡å‹ç»“æœ
- sqlnet/ - SQLNetæ¨¡å‹ç»“æœ
- seq2seq_attention_copy/ - Seq2Seqæ¨¡å‹ç»“æœ
- nl2code/ - NL2Codeæ¨¡å‹ç»“æœ

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä¸€é”®éªŒè¯ï¼ˆæ¨èï¼‰
```bash
chmod +x validate_spider.sh
./validate_spider.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨éªŒè¯
```bash
# ç¼–è¯‘é¡¹ç›®
mvn clean compile

# è¿è¡Œæµ‹è¯•
mvn test -Dtest=SpiderLogicValidationTest

# æ„å»ºJARåŒ…
mvn package -DskipTests

# å®Œæ•´éªŒè¯
java -jar target/spider-evaluation-1.0.0.jar validate-all data/spider
```

### æ–¹æ³•3: åˆ†æ­¥éªŒè¯
```bash
# æ•°æ®éªŒè¯
java -jar target/spider-evaluation-1.0.0.jar validate-data data/spider

# é€»è¾‘éªŒè¯
java -jar target/spider-evaluation-1.0.0.jar validate-logic \
    evaluation_examples/gold_example.txt \
    evaluation_examples/pred_example.txt \
    data/spider/database \
    data/spider/tables.json \
    all
```

## éªŒè¯æŒ‡æ ‡

### SQLéš¾åº¦åˆ†çº§
- **Easy** - ç®€å•æŸ¥è¯¢
- **Medium** - ä¸­ç­‰å¤æ‚åº¦æŸ¥è¯¢
- **Hard** - å¤æ‚æŸ¥è¯¢
- **Extra Hard** - æå¤æ‚æŸ¥è¯¢

### è¯„ä¼°ç±»å‹
- **match** - ç»“æ„åŒ¹é…ï¼ˆä¸è€ƒè™‘å€¼ï¼‰
- **exec** - æ‰§è¡Œå‡†ç¡®æ€§
- **all** - å®Œæ•´è¯„ä¼°ï¼ˆç»“æ„+æ‰§è¡Œï¼‰

### è¯„ä¼°ç»„ä»¶
- SELECTåˆ—åŒ¹é…
- WHEREæ¡ä»¶åŒ¹é…
- GROUP BYåŒ¹é…
- ORDER BYåŒ¹é…
- èšåˆå‡½æ•°åŒ¹é…
- åµŒå¥—æŸ¥è¯¢åŒ¹é…
- SQLå…³é”®è¯åŒ¹é…

## é¡¹ç›®çŠ¶æ€

### âœ… å·²å®Œæˆ
- [x] æ ¸å¿ƒéªŒè¯æµ‹è¯•ç±»
- [x] æ•°æ®éªŒè¯å·¥å…·
- [x] éªŒè¯å‘½ä»¤è¡Œå·¥å…·
- [x] è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬
- [x] è¯¦ç»†æ–‡æ¡£
- [x] é¡¹ç›®ç¼–è¯‘æˆåŠŸ
- [x] æ‰€æœ‰ç»„ä»¶é›†æˆå®Œæˆ

### ğŸ¯ éªŒè¯ç›®æ ‡
- [x] ä½¿ç”¨baselinesæ•°æ®éªŒè¯
- [x] ä½¿ç”¨dataæ•°æ®éªŒè¯
- [x] ä½¿ç”¨eval_testæ•°æ®éªŒè¯
- [x] ä½¿ç”¨evaluation_examplesæ•°æ®éªŒè¯
- [x] æ”¯æŒå¤šç§è¯„ä¼°ç±»å‹
- [x] æä¾›è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Š
- [x] æ”¯æŒæ‰¹é‡éªŒè¯

## ä¸‹ä¸€æ­¥æ“ä½œ

1. **è¿è¡ŒéªŒè¯**ï¼šæ‰§è¡Œ `./validate_spider.sh` è¿›è¡Œå®Œæ•´éªŒè¯
2. **æŸ¥çœ‹ç»“æœ**ï¼šæ£€æŸ¥éªŒè¯è¾“å‡ºï¼Œç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
3. **è°ƒè¯•é—®é¢˜**ï¼šå¦‚æœ‰æµ‹è¯•å¤±è´¥ï¼ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—è¿›è¡Œè°ƒè¯•
4. **æ‰©å±•åŠŸèƒ½**ï¼šæ ¹æ®éœ€è¦æ·»åŠ æ–°çš„éªŒè¯æµ‹è¯•æˆ–è¯„ä¼°æŒ‡æ ‡

## æŠ€æœ¯è§„æ ¼

- **Javaç‰ˆæœ¬**: 17+
- **Mavenç‰ˆæœ¬**: 3.6+
- **æµ‹è¯•æ¡†æ¶**: JUnit 5
- **JSONå¤„ç†**: Jackson 2.15.2
- **æ•°æ®åº“**: SQLite 3.42.0
- **æ—¥å¿—æ¡†æ¶**: SLF4J + Logback

## ç»“è®º

æ‚¨çš„Spider Javaç‰ˆæœ¬é€»è¾‘éªŒè¯æ¡†æ¶å·²ç»å®Œå…¨å®ç°å¹¶å¯ä»¥ä½¿ç”¨ã€‚è¿™ä¸ªæ¡†æ¶å°†å¸®åŠ©æ‚¨ï¼š

1. **éªŒè¯æ•°æ®å®Œæ•´æ€§** - ç¡®ä¿æ‰€æœ‰å¿…éœ€çš„æ•°æ®æ–‡ä»¶éƒ½å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
2. **éªŒè¯é€»è¾‘æ­£ç¡®æ€§** - ç¡®ä¿Javaç‰ˆæœ¬çš„è¯„ä¼°é€»è¾‘ä¸åŸå§‹Pythonç‰ˆæœ¬ä¸€è‡´
3. **æ”¯æŒå¤šç§éªŒè¯åœºæ™¯** - æ”¯æŒä¸åŒçš„æ•°æ®æºå’Œè¯„ä¼°ç±»å‹
4. **æä¾›è¯¦ç»†çš„åé¦ˆ** - æä¾›æ¸…æ™°çš„éªŒè¯ç»“æœå’Œé”™è¯¯ä¿¡æ¯

é€šè¿‡è¿™ä¸ªéªŒè¯æ¡†æ¶ï¼Œæ‚¨å¯ä»¥ç¡®ä¿¡æ‚¨çš„Javaç‰ˆæœ¬Spiderå®ç°æ˜¯æ­£ç¡®å’Œå¯é çš„ã€‚

---

**ğŸ‰ é¡¹ç›®å®Œæˆï¼æ‚¨ç°åœ¨å¯ä»¥å¼€å§‹ä½¿ç”¨éªŒè¯æ¡†æ¶æ¥éªŒè¯æ‚¨çš„Spider Javaå®ç°äº†ã€‚** 